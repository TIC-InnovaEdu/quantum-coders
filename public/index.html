<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Runa Pachawan</title>
    <!-- Icono optimizado: Usamos Runa01.png por ser cuadrado y legible en escalas peque√±as -->
    <link rel="icon" type="image/png" sizes="32x32" href="Resources/Items/Runa01.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="Resources/Items/Runa01.png" />
    <link rel="apple-touch-icon" href="Resources/Items/Runa01.png" />
    <link rel="manifest" href="site.webmanifest" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="Runa Pachawan" />
  <link rel="stylesheet" href="estilos.css" />
  <link rel="stylesheet" href="interface.css" />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Papyrus&display=swap"
    rel="stylesheet">

  <script type="module" src="auth.js"></script>
</head>

<body>
  <div id="authScreen" class="fullscreen" style="display: none;">
    <h1 id="authTitle">RUNA PACHAWAN</h1>
    <div class="auth-card">
      <div class="auth-tabs">
        <button id="tabLogin" class="active">Iniciar sesi√≥n</button>
        <button id="tabRegister">Crear cuenta</button>
      </div>
      <form id="authLoginForm" class="auth-form">
        <label>Usuario</label>
        <input id="loginEmail" type="text" class="auth-input" required placeholder="Tu nombre de usuario" />
        <label>Contrase√±a</label>
        <input id="loginPassword" type="password" class="auth-input" required />
        <div class="auth-actions">
          <button type="submit" class="primary">Entrar</button>
        </div>
        <div id="authLoginMessage" class="auth-message"></div>
        <div class="auth-divider"><span>O continuar con</span></div>
        <button type="button" id="btnGoogleLogin" class="google-btn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="20" alt="Google">
          Google
        </button>
      </form>
      <form id="authRegisterForm" class="auth-form" style="display:none;">
        <label>Nombre Completo</label>
        <input id="regName" type="text" class="auth-input" required maxlength="40" placeholder="Ej: Juan P√©rez" />
        <label>Usuario</label>
        <input id="regEmail" type="text" class="auth-input" required placeholder="Ej: juanito123" />
        <label>Contrase√±a</label>
        <input id="regPassword" type="password" class="auth-input" required minlength="6" />
        <div class="auth-actions">
          <button type="submit" class="primary">Crear cuenta</button>
        </div>
        <div id="authRegisterMessage" class="auth-message"></div>
      </form>
    </div>
  </div>
  <!-- Men√∫ Universal (Control Center) -->
  <div id="menu" class="summary-modal" style="display: none;">
    <div class="summary-box">
      <h1 id="gameTitle">RUNA PACHAWAN</h1>

      <!-- Secci√≥n de Estad√≠sticas (Solo visible en Game Over / Victoria) -->
      <div id="menuStats" class="summary-stats" style="display: none;">
        <h2 id="menuStatusTitle" style="font-size: 1.5em; margin-bottom: 15px;">Resumen</h2>
        <div class="stat-item">
          <span class="stat-label">Puntuaci√≥n:</span>
          <span id="menuScore" class="stat-value">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Sabidur√≠a:</span>
          <span id="menuWisdom" class="stat-value">0</span>
        </div>
        <p id="menuMessage" class="auto-save-status"></p>
      </div>

      <div class="menu-options">
        <button id="playButton" class="primary">Iniciar Aventura</button>
        <button id="restartButton" class="primary" style="display: none;">Reiniciar Partida</button>
        <button id="leaderboardButton" class="primary">Mejores Puntajes</button>
        <button id="logoutButton" class="primary logout-btn">Cerrar Sesi√≥n</button>
      </div>

      <div id="menuControls" class="controls">
        <h3>Controles:</h3>
        <p id="currentUserDisplay"></p>
        <div class="controls-grid">
          <span>ü°Ü ü°Ñ ü°Ö ü°á : Moverse</span>
          <span>A : Atacar / Responder</span>
          <span>B : Interactuar</span>
          <span>ESC : Pausa / Men√∫</span>
        </div>
      </div>
    </div>
  </div>
  <div id="game-container">
    <div class="background" id="background"></div>
    <div id="stage">
      <div id="floor"></div>
      <!-- Nivel 1 -->
      <div class="platforms-scene-1">
      </div>

      <!-- Plataformas visibles solo en escena 2 -->
      <div class="platforms-scene-2" style="display: none;">
        <!-- Plataforma 1 -->
        <div class="platform" style="left: 350px; bottom: 180px; width: 120px; height: 20px;"></div>
        <div class="blocker-wall" style="left: 350px; bottom: 100px; width: 120px; height: 80px;"></div>

        <!-- Plataforma 2 -->
        <div class="platform" style="left: 700px; bottom: 250px; width: 120px; height: 20px;"></div>

        <!-- Plataforma 3 -->
        <div class="platform" style="left: 900px; bottom: 390px; width: 120px; height: 20px;"></div>
      </div>

      <!--Scenario 3-->
      <div class="platforms-scene-3" style="display: none;">
        <!-- Plataforma izquierda -->
        <div class="platform" style="left: 200px; bottom: 200px; width: 120px; height: 20px;"></div>
        <div class="platform" style="left: 200px; bottom: 320px; width: 120px; height: 20px;"></div>
        <!-- Plataforma derecha -->
        <div class="platform" style="left: 1200px; bottom: 200px; width: 120px; height: 20px;"></div>
        <div class="platform" style="left: 1200px; bottom: 320px; width: 120px; height: 20px;"></div>
      </div>

      <!-- Nivel 4 -->
      <div class="platforms-scene-4" style="display: none;">
        <!-- Plataforma inicial -->
        <div class="platform green" style="left: 100px; bottom: 160px; width: 180px; height: 20px;"></div>
        <!-- Plataforma peque√±a -->
        <div class="platform green" style="left: 400px; bottom: 300px; width: 80px; height: 20px;"></div>
        <!-- Plataforma mediana -->
        <div class="platform green" style="left: 650px; bottom: 220px; width: 120px; height: 20px;"></div>
        <div class="platform green" style="left: 950px; bottom: 150px; width: 80px; height: 20px;"></div>
        <!-- Plataforma -->
        <div class="platform green" style="left: 1300px; bottom: 150px; width: 180px; height: 20px;"></div>
        <div class="quicksand" id="quicksand4"></div>
        <!-- Runa 4 -->
        <div class="collectible" id="runa4"></div>
        <!-- Mensaje de Ayllu -->
        <div id="ayllu-warning">
          <div id="ayllu4-float"></div>
          <div id="ayllu4-text">Cuidado con las arenas movedizas, si te caes lo lamentar√°s...</div>
        </div>
      </div>


      <!-- Nivel 5 -->
      <div class="platforms-scene-5" style="display: none;">
        <!-- Plataforma inicial -->
        <div class="platform green" style="left: 80px; bottom: 180px; width: 160px; height: 20px;"></div>
        <!-- Plataforma mediana -->
        <div class="platform green" style="left: 350px; bottom: 320px; width: 120px; height: 20px;"></div>
        <!-- Plataforma peque√±a -->
        <div class="platform green" style="left: 600px; bottom: 220px; width: 70px; height: 20px;"></div>
        <div class="platform green" style="left: 900px; bottom: 180px; width: 20px; height: 20px;"></div>
        <div class="platform green" style="left: 1200px; bottom: 180px; width: 160px; height: 20px;"></div>
        <div class="quicksand" id="quicksand5"></div>
        <!-- Runa coleccionable -->
        <div class="collectible" id="runa5"></div>
      </div>

      <!-- Nivel 6 -->
      <div class="platforms-scene-6" style="display: none;">
        <!-- Plataformas en zigzag -->
        <div class="platform" style="left: 100px; bottom: 150px; width: 120px; height: 20px;"></div>
        <div class="platform" style="left: 300px; bottom: 290px; width: 120px; height: 20px;"></div>
        <div class="platform" style="left: 500px; bottom: 150px; width: 120px; height: 20px;"></div>
        <div class="platform" style="left: 700px; bottom: 290px; width: 120px; height: 20px;"></div>
        <div class="platform" style="left: 900px; bottom: 150px; width: 120px; height: 20px;"></div>
        <div class="platform" style="left: 1100px; bottom: 290px; width: 120px; height: 20px;"></div>
        <div class="platform" style="left: 1300px; bottom: 150px; width: 120px; height: 20px;"></div>
        <div class="platform" style="left: 1500px; bottom: 220px; width: 120px; height: 20px;"></div>

        <div class="spanish-enemy" style="left: 670px; bottom: 100px;"></div>
        <div class="spanish-enemy" style="left: 1122px; bottom: 310px;"></div>

        <!-- Runa coleccionable -->
        <div class="collectible" id="runa6"></div>
      </div>


      <!-- Nivel 7 -->
      <div class="platforms-scene-7" style="display: none;">
        <!-- Plataformas verticales -->
        <div class="platform" style="left: 200px; bottom: 100px; width: 80px; height: 20px;"></div>
        <div class="platform" style="left: 300px; bottom: 200px; width: 80px; height: 20px;"></div>
        <div class="platform" style="left: 400px; bottom: 300px; width: 80px; height: 20px;"></div>
        <div class="platform" style="left: 500px; bottom: 400px; width: 80px; height: 20px;"></div>

        <div class="platform" style="left: 1150px; bottom: 100px; width: 80px; height: 20px;"></div>
        <div class="platform" style="left: 1150px; bottom: 200px; width: 80px; height: 20px;"></div>
        <div class="platform" style="left: 1150px; bottom: 300px; width: 80px; height: 20px;"></div>
        <div class="platform" style="left: 1150px; bottom: 400px; width: 80px; height: 20px;"></div>

        <div class="platform" style="left: 900px; bottom: 200px; width: 80px; height: 20px;"></div>
        <div class="platform" style="left: 800px; bottom: 300px; width: 80px; height: 20px;"></div>

        <div class="spanish-enemy" style="left: 1150px; bottom: 120px;"></div>
        <div class="spanish-enemy" style="left: 1150px; bottom: 220px;"></div>
        <div class="spanish-enemy" style="left: 1150px; bottom: 320px;"></div>

        <div class="collectible" id="runa7"></div>
      </div>

      <!-- Nivel 8 -->

      <!-- Nivel 8 -->

      <div class="platforms-scene-8" style="display: none;">

        <div class="platform moving" style="left: 600px; bottom: 150px; width: 100px; height: 20px;"></div>
        <div class="platform moving" style="left: 800px; bottom: 250px; width: 100px; height: 20px;"></div>
        <div class="platform moving" style="left: 1000px; bottom: 350px; width: 100px; height: 20px;"></div>
        <div class="platform" style="left: 1200px; bottom: 450px; width: 180px; height: 20px;"></div>

        <div class="collectible" id="runa8"></div>
      </div>

      <div id="eagleBoss" style="display: none;">
        <div class="boss" id="eagle"></div>
        <img id="feather-sprite" src="Resources/First_Boss/eagle_atk_mag.png" style="display:none">
      </div>

      <div class="collectible" id="runa1" style="left: 700px; bottom: 180px;"></div>
      <div class="character" id="player"></div>
      <!--Integraci√≥n de Ayllu-->
      <div class="companion" id="ayllu">
        <div class="npc-label">Presiona 'B'</div>
      </div>
      <div class="scene-trigger" id="trigger1"></div>
      <div class="enemy" id="puma" style="display: none;"></div>

      <div class="blocker" style="left: 1250px; bottom: 100px;"></div>
      <!-- Cuadro de pregunta tipo quiz -->
      <div id="quiz-container" style="display: none;">
        <div id="quiz-box">
          <p id="quiz-question">Pregunta aqu√≠...</p>
          <ul id="quiz-options">
            <li class="quiz-option selected">Opci√≥n 1</li>
            <li class="quiz-option">Opci√≥n 2</li>
            <li class="quiz-option">Opci√≥n 3</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- UI INTERFACE LAYER (Fixed HUD) -->
    <div id="ui-layer">
      <div id="life-bar">
        <img id="lifeImage" src="Resources/vida4.png" />
      </div>
      <!-- Contador de sabidur√≠a -->
      <div id="wisdom-bar">
        <span id="wisdom-label">Sabidur√≠a:</span>
        <span id="wisdom-points">0</span>
      </div>
      <!-- Nickname del jugador durante gameplay - Abre Men√∫ de Pausa -->
      <div id="player-nick-hud" style="display: none;" onclick="window.togglePause()">
        <img id="hud-player-photo" src="https://cdn-icons-png.flaticon.com/512/1144/1144760.png" alt="User">
        <div id="hud-name-container">
          <span id="hud-player-name">Jugador</span>
        </div>
        <i class="menu-arrow">‚ñº</i>
      </div>
      <div id="eagle-life-bar" style="display: none;">
        <img id="eagleLifeImage" src="Resources/First_Boss/vida_full_eagle.png" />
      </div>
      <div id="gameOverScreen" style="display: none;">
        <h1>Game Over</h1>
        <p>Has perdido todas tus vidas.</p>
      </div>
      <!-- Mensaje central para aciertos/errores -->
      <div id="centerMessage" style="display: none;">
        <p id="centerMessageText"></p>
      </div>
    </div>
  </div>
  <!-- Quiz de Runas -->
  <div id="runa-quiz-container" style="display: none;">
    <div id="runa-quiz-box">
      <p id="runa-quiz-question"></p>
      <ul id="runa-quiz-options"></ul>
    </div>
  </div>
  <div id="overlay"></div>
  <div id="introScene">
    <div id="introText"></div>
    <div id="continuePrompt" style="display: none;">Presiona 'B' para continuar</div>
  </div>

  <!-- Advertencia de Resoluci√≥n Peque√±a -->
  <div id="resolution-warning">
    <h2>Dispositivo No Compatible</h2>
    <p>Tu pantalla es demasiado peque√±a para mostrar el juego correctamente.</p>
    <p>Por favor, gira tu dispositivo a horizontal o agranda la ventana.</p>
  </div>

  <!-- El modal de Leaderboard se mantiene porque es un overlay sobre el men√∫ principal/pausa -->
  <div id="leaderboardModal" class="summary-modal" style="display: none;">
    <div class="summary-box">
      <h2>Mejores Puntajes</h2>
      <div id="leaderboardList" class="leaderboard-container">
        <p>Cargando puntajes...</p>
      </div>
      <button id="closeLeaderboardBtn" class="primary" style="margin-top: 20px;">Volver</button>
    </div>
  </div>
  <script src="func.js"></script>
</body>

</html>